(this["webpackJsonpshopping-cart"]=this["webpackJsonpshopping-cart"]||[]).push([[0],{28:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(20),s=n.n(a),i=(n(28),n(7)),o=n(11),u=n(5),j=n(0);var h=function(e){return Object(j.jsxs)("div",{className:"Home",children:[Object(j.jsx)("h1",{children:"Home"}),Object(j.jsx)("p",{children:"Welcome to the currency-buying site! Lose money in the shop!"})]})},b=n(13),d=n.n(b),l=n(15);var O=function(e){var t=Object(c.useState)({}),n=Object(i.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(""),u=Object(i.a)(s,2),h=u[0],b=u[1],O=function(e){b(e.target.value)},p=function(t){t.preventDefault();var n=t.target.querySelector("input"),c=parseInt(h),a=Object.entries(r).filter((function(e){var t=Object(i.a)(e,2),c=t[0];t[1];return c===n.id}));""!==h?(e.onSubmit({currency:n.name,rate:a[0][1],amount:c}),n.value="",b("")):alert("Please enter a currency amount between 1 and 100 units")},f=function(){var e=Object(l.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.exchangeratesapi.io/latest?base=GBP").then((function(e){if(e.ok)return e.json();throw new Error("Currency API Shop didn't work")})).then((function(e){var t=e.rates;a(t)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e=document.getElementById("stickyNav"),t=document.getElementById("shopPage"),n=e.offsetTop;window.onscroll=function(){!function(e,t,n){window.pageYOffset>=n?(t.classList.add("expand"),e.classList.add("sticky")):(t.classList.remove("expand"),e.classList.remove("sticky"))}(e,t,n)},f()}),[]),Object(j.jsxs)("div",{className:"Shop",id:"shopPage",children:[Object(j.jsx)("h2",{children:"Buy Currency!"}),Object(j.jsx)("div",{className:"ShopList",children:Object.entries(r).map((function(e){var t=Object(i.a)(e,2),n=t[0],c=t[1];return"GBP"===n?Object(j.jsxs)("div",{className:"ShopItem",id:"BaseCurrency",children:[Object(j.jsxs)("p",{children:["Base Currency: ",n]}),Object(j.jsxs)("p",{children:["Rate: ",c,".00"]})]},n):Object(j.jsxs)("form",{onSubmit:p,className:"ShopItem",children:[Object(j.jsxs)(o.b,{to:"/shop/".concat(n),children:["Currency code: ",n]}),Object(j.jsxs)("p",{id:"rate",children:["Rate: ",c.toFixed(2)]}),Object(j.jsx)("label",{htmlFor:n,children:"Amount (1-100 units)"}),Object(j.jsx)("input",{type:"number",id:n,name:n,min:"1",max:"100",amount:h,onChange:O}),Object(j.jsx)("button",{children:"Buy!"})]},n)}))})]})},p=n(22),f=n(44),x=n(45),m=n(43),v=n(23),y=n.n(v);var k=function(){var e=Object(u.f)().currency,t=Object(f.a)(new Date,"yyyy-MM-dd"),n=Object(f.a)(Object(x.a)(new Date,8),"yyyy-MM-dd"),r=Object(c.useState)({}),a=Object(i.a)(r,2),s=(a[0],a[1],Object(c.useState)({})),o=Object(i.a)(s,2),h=o[0],b=o[1];Object(c.useEffect)((function(){O()}),[]);var O=function(){var c=Object(l.a)(d.a.mark((function c(){return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,fetch("https://api.exchangeratesapi.io/history?start_at=".concat(n,"&end_at=").concat(t,"&base=GBP&symbols=").concat(e)).then((function(e){if(e.ok)return e.json();throw new Error("Currency API ItemDetail didn't work")})).then((function(t){for(var n=Object.entries(t.rates).map((function(t){var n=Object(i.a)(t,2),c=n[0],r=n[1];return Object(p.a)({},c,r[e])})),c=Object.keys(t.rates).map((function(e){return y()(e)})).sort(m.a).map((function(e){return Object(f.a)(e,"yyyy-MM-dd")})).map((function(e){return[e,""]})),r=0;r<c.length;r++)for(var a=0;a<n.length;a++){var s=n[a],o=Object.keys(s);c[r][0]===o[0]&&(c[r][1]=s[c[r][0]])}b(c)})).catch((function(e){console.error(e)}));case 2:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();return h.length>0?Object(j.jsxs)("div",{className:"ItemDetail",children:[Object(j.jsxs)("h1",{children:[e," to GBP"]}),Object(j.jsx)("h2",{children:"Previous 7 Working Days"}),h.map((function(e){return Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:["Currency: ",e[0]]}),Object(j.jsxs)("p",{children:["Rate: ",e[1]]})]},e[0])}))]}):Object(j.jsx)("p",{children:"Loading..."})};var g=function(e){var t=e.basket,n=function(t){return function(){e.onRemove(t)}};return 0===t.length?Object(j.jsx)("div",{className:"EmptyBasket",children:Object(j.jsx)("p",{children:"Empty Basket!"})}):Object(j.jsx)("div",{className:"Basket",children:t.map((function(e){return Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:["Currency: ",e.currency]}),Object(j.jsxs)("p",{children:["Rate: ",e.rate.toFixed(2)]}),Object(j.jsxs)("p",{children:["Amount: ",e.amount]}),Object(j.jsxs)("p",{children:["Total ",e.currency,": ",(e.rate*e.amount).toFixed(2)]}),Object(j.jsx)("button",{onClick:n(e),children:"Remove"})]},e.currency)}))})};var w=function(e){var t=e.basket,n=Object(c.useState)(0),r=Object(i.a)(n,2),a=r[0],s=r[1];return Object(c.useEffect)((function(){if(0===t.length)s(0);else{var e=[];t.forEach((function(t){e.push(t.amount)}));var n=e.reduce((function(e,t){return e+t}));s(n)}}),[t]),Object(j.jsxs)("div",{className:"Summary",children:[Object(j.jsxs)("p",{children:["Total cost: \xa3",a]}),Object(j.jsx)("button",{onClick:function(){alert("You bought the currency! WHY?!")},children:"Buy"})]})};var S=function(e){var t=e.basket;return Object(j.jsxs)("div",{className:"Checkout",children:[Object(j.jsx)("h2",{children:"Checkout"}),Object(j.jsx)(g,{basket:t,onRemove:function(t){e.onRemove(t)}}),Object(j.jsx)(w,{basket:t})]})};var B=function(e){return Object(j.jsx)("div",{className:"Footer",children:Object(j.jsxs)("p",{children:["Currency rates provided by ",Object(j.jsx)("a",{href:"https://www.exchangerate-api.com/",children:"ExchangeRate-API"})]})})};var C=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(j.jsx)(o.a,{children:Object(j.jsxs)("div",{className:"AppContent",children:[Object(j.jsxs)("nav",{children:[Object(j.jsx)(o.b,{to:"/shopping-cart/",id:"HomeLink",children:"Home"}),Object(j.jsx)(o.b,{to:"/shop",id:"ShopLink",children:"Shop"})]}),Object(j.jsxs)(u.c,{children:[Object(j.jsx)(u.a,{exact:!0,path:"/shopping-cart/",children:Object(j.jsx)(h,{})}),Object(j.jsxs)(u.a,{exact:!0,path:"/shop",children:[Object(j.jsxs)("div",{className:"StickyBar",id:"stickyNav",children:[Object(j.jsxs)("p",{children:["Items in Basket: ",n.length]}),Object(j.jsx)(o.b,{to:"/checkout",children:"Checkout"})]}),Object(j.jsx)(O,{onSubmit:function(e){var t,c=n;if(c.length>0){var a=c.findIndex((function(t){return t.currency===e.currency}));-1===a?t=c.concat(e):(c[a].amount+=e.amount,t=c)}else t=c.concat(e);r(t)}})]}),Object(j.jsx)(u.a,{path:"/shop/:currency",component:k}),Object(j.jsx)(u.a,{path:"/checkout",children:Object(j.jsx)(S,{basket:n,onRemove:function(e){var t=n.filter((function(t){return t.currency!==e.currency}));r(t)}})})]}),Object(j.jsx)(B,{})]})})};s.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(C,{})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.f119db14.chunk.js.map