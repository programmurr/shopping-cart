{"version":3,"sources":["components/Home.js","components/shop-components/Shop.js","components/shop-components/ItemDetail.js","components/checkout-components/Basket.js","components/checkout-components/Summary.js","components/checkout-components/Checkout.js","components/Footer.js","App.js","index.js"],"names":["Home","props","className","Shop","useState","currencies","setCurrencies","buyAmount","setBuyAmount","handleChange","e","target","value","handleSubmit","preventDefault","input","querySelector","amount","parseInt","rate","Object","entries","filter","currency","id","onSubmit","name","alert","fetchCurrencies","a","fetch","then","response","ok","json","Error","responseJson","rates","catch","err","console","error","useEffect","navBar","document","getElementById","shop","sticky","offsetTop","window","onscroll","pageYOffset","classList","add","remove","handleScroll","map","to","toFixed","htmlFor","type","min","max","onChange","ItemDetail","useParams","today","format","Date","lastWeek","subDays","historyRates","setHistoryRates","fetchItem","rateArray","date","rateObj","dateArray","keys","parseISO","sort","compareAsc","i","length","j","Basket","basket","handleRemove","item","onRemove","onClick","Summary","cost","setCost","amounts","forEach","push","sum","reduce","accumulator","currentValue","Checkout","Footer","href","App","setBasket","exact","path","newItem","newBasket","oldBasket","index","findIndex","oldItem","concat","component","removedItem","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.f119db14.chunk.js","sourcesContent":["import React from 'react';\n\nfunction Home(props) {\n  return (\n    <div className=\"Home\">\n      <h1>Home</h1>\n      <p>\n        Welcome to the currency-buying site! Lose money in the shop!\n      </p>\n    </div>\n  );\n}\n\nexport default Home;","import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\n\nfunction Shop(props) {\n  const [ currencies, setCurrencies ] = useState({});\n  const [ buyAmount, setBuyAmount ] = useState(\"\");\n\n  const handleChange = (e) => {\n    setBuyAmount(e.target.value);\n  }\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    const form = e.target;\n    const input = form.querySelector('input');\n    const amount = parseInt(buyAmount);\n    const rate = Object.entries(currencies).filter(([currency, rate]) => (currency === input.id));\n\n    if (buyAmount === \"\") {\n      alert('Please enter a currency amount between 1 and 100 units');\n      return;\n    }\n    props.onSubmit({\n      currency: input.name,\n      rate: rate[0][1],\n      amount: amount\n    });\n\n    input.value = \"\";\n    setBuyAmount(\"\");\n  }\n\n  const handleScroll = (navBar, shop, sticky) => {\n    if (window.pageYOffset >= sticky) {\n      shop.classList.add('expand');\n      navBar.classList.add('sticky');\n    } else {\n      shop.classList.remove('expand');\n      navBar.classList.remove('sticky');\n    }\n  }\n\n  const fetchCurrencies = async () => {\n    await fetch(`https://api.exchangeratesapi.io/latest?base=GBP`)\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        } else {\n          throw new Error(\"Currency API Shop didn't work\");\n        }\n      })\n      .then((responseJson) => {\n          const rates = responseJson.rates;\n          setCurrencies(rates); \n      })\n      .catch((err) => {\n        console.error(err);\n      });\n  }\n\n  useEffect(() => {\n    const navBar = document.getElementById('stickyNav');\n    const shop = document.getElementById('shopPage');\n    const sticky = navBar.offsetTop;\n  \n    window.onscroll = () => { handleScroll(navBar, shop, sticky); }\n\n    fetchCurrencies();\n  }, [])\n\n  \n\n  return (\n      <div className=\"Shop\" id=\"shopPage\">\n        <h2>Buy Currency!</h2>\n        <div className=\"ShopList\">\n        {Object.entries(currencies).map(([currency, rate]) => (\n          currency === 'GBP' ? \n            <div key={currency} className=\"ShopItem\" id=\"BaseCurrency\">\n              <p>Base Currency: {currency}</p>\n              <p>Rate: {rate}.00</p>\n            </div>\n            : <form onSubmit={handleSubmit} key={currency} className=\"ShopItem\">\n                <Link to={`/shop/${currency}`}>Currency code: {currency}</Link>\n                <p id=\"rate\">Rate: {rate.toFixed(2)}</p>\n                <label htmlFor={currency}>Amount (1-100 units)</label>\n                <input \n                  type=\"number\" \n                  id={currency} \n                  name={currency} \n                  min=\"1\" \n                  max=\"100\" \n                  amount={buyAmount}\n                  onChange={handleChange}\n                />\n                <button>Buy!</button>\n              </form>\n        ))}\n        </div>\n      </div>\n  );\n}\n\nexport default Shop;","import React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { format, compareAsc, subDays } from 'date-fns';\nimport parseISO from 'date-fns/parseISO'\n\nfunction ItemDetail() {\n  let { currency } = useParams();\n  const today = format(new Date(), 'yyyy-MM-dd');\n  const lastWeek = format(subDays(new Date(), 8), 'yyyy-MM-dd');\n\n  const [ historyObject, setHistoryObject ] = useState({});\n  const [ historyRates, setHistoryRates ] = useState({});\n\n  useEffect(() => {\n    fetchItem();\n  }, [])\n\n  const fetchItem = async () => {\n    await fetch(\n      `https://api.exchangeratesapi.io/history?start_at=${lastWeek}&end_at=${today}&base=GBP&symbols=${currency}`\n    ).then((response) => {\n      if (response.ok) {\n        return response.json();\n      } else {\n        throw new Error(\"Currency API ItemDetail didn't work\");\n      }\n    })\n    .then((responseJson) => {\n      // There is a better way of doing this out there somewhere, but it's beyond me.\n      // responseJson.rates is a nested Object. It arrives in date order, but iterating\n      // over it with Object.entries() throws everything off (WHY?!). So I made the below \n      // monstrous transformation to un-nest the responseJson.rates, sort the dates, \n      // put them in an array to keep them in order, then find the corresponding rate and \n      // pair them together in the dateArray. There's probably some show-off out there who\n      // can do it in one line. I DON'T CARE.\n      const rateArray = Object.entries(responseJson.rates).map(([date, rateObj]) => (\n        {[date]: rateObj[currency]}\n      ));\n\n      const dateArray = Object.keys(responseJson.rates)\n        .map((date) => (parseISO(date)))\n        .sort(compareAsc)\n        .map((date) => (format(date, 'yyyy-MM-dd')))\n        .map((date) => (\n          [date, \"\"]\n        ));\n\n      for (let i = 0; i < dateArray.length; i++) {\n        for (let j = 0; j < rateArray.length; j++) {\n          const rateObj = rateArray[j];\n          const keys = Object.keys(rateObj);\n          if (dateArray[i][0] === keys[0]) {\n            dateArray[i][1] = rateObj[dateArray[i][0]]\n          }\n        }\n      }\n      setHistoryRates(dateArray);\n      })\n      .catch((err) => {\n        console.error(err);\n      });\n    }\n\n    if (historyRates.length > 0) {\n      return (\n        <div className=\"ItemDetail\">\n          <h1>{currency} to GBP</h1>\n          <h2>Previous 7 Working Days</h2>\n          {historyRates.map((rate) => (\n            <div key={rate[0]}>\n              <p>Currency: {rate[0]}</p>\n              <p>Rate: {rate[1]}</p>\n            </div>\n          ))}\n        </div>\n      )\n    } else {\n      return (\n        <p>Loading...</p>\n      );\n    }\n}\n\nexport default ItemDetail;","import React from 'react';\n\nfunction Basket(props) {\n  const { basket } = props;\n\n  const handleRemove = (item) => () => {\n    props.onRemove(item);\n  }\n\n  if (basket.length === 0) {\n    return (\n      <div className=\"EmptyBasket\">\n        <p>Empty Basket!</p>\n      </div>\n    )\n  } else {\n    return (\n      <div className=\"Basket\">\n        {basket.map((item) => (\n          <div key={item.currency}>\n            <p>Currency: {item.currency}</p>\n            <p>Rate: {item.rate.toFixed(2)}</p>\n            <p>Amount: {item.amount}</p>\n            <p>Total {item.currency}: {(item.rate * item.amount).toFixed(2)}</p>\n            <button onClick={handleRemove(item)}>Remove</button>\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default Basket;","import React, { useState, useEffect } from 'react';\n\nfunction Summary(props) {\n  const { basket } = props;\n\n  const [ cost, setCost ] = useState(0);\n\n  useEffect(() => {\n    if (basket.length === 0) {\n      setCost(0);\n    } else {\n      let amounts = [];\n      basket.forEach(item => {\n        amounts.push(item.amount);\n      });\n      const reducer = (accumulator, currentValue) => accumulator + currentValue;\n      const sum = amounts.reduce(reducer);      \n      setCost(sum);\n    }\n  }, [basket])\n\n  const handleBuy = () => {\n    alert(\"You bought the currency! WHY?!\")\n  }\n\n\n  return (\n    <div className=\"Summary\">\n      <p>Total cost: Â£{cost}</p>\n      <button onClick={handleBuy}>Buy</button>\n    </div>\n  );\n}\n\nexport default Summary;","import React from 'react';\nimport Basket from './Basket';\nimport Summary from './Summary';\n\nfunction Checkout(props) {\n  const { basket } = props; \n\n  const handleRemove = (item) => {\n    props.onRemove(item);\n  }\n  \n  return (\n    <div className=\"Checkout\">\n      <h2>Checkout</h2>\n      <Basket basket={basket} onRemove={handleRemove}/>\n      <Summary basket={basket}/>\n    </div>\n  );\n}\n\nexport default Checkout;","import React from 'react';\n\nfunction Footer(props) {\n  return (\n    <div className=\"Footer\">\n      <p>\n        Currency rates provided by <a href=\"https://www.exchangerate-api.com/\">ExchangeRate-API</a>\n      </p>\n    </div>\n  );\n}\n\nexport default Footer;","import React, { useState } from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route, \n  Link\n} from 'react-router-dom';\nimport Home from './components/Home';\nimport Shop from './components/shop-components/Shop';\nimport ItemDetail from './components/shop-components/ItemDetail';\nimport Checkout from './components/checkout-components/Checkout';\nimport Footer from './components/Footer';\n\n\nfunction App() {\n\n  const [ basket, setBasket ] = useState([]);\n\n  // Checks to see if the current purchased item already exists in the cart\n  // If it already exists, it adds to the existing amount\n  // If not, it concatenates it on to the basket\n  const handleSubmit = (newItem) => {\n    const oldBasket = basket;\n    let newBasket;\n\n    if (oldBasket.length > 0) {\n      const index = oldBasket.findIndex((oldItem) => (oldItem.currency === newItem.currency));\n      if (index === -1) {\n        newBasket = oldBasket.concat(newItem);\n      } else {\n        oldBasket[index].amount += newItem.amount;\n        newBasket = oldBasket;\n      }\n    } else {\n      newBasket = oldBasket.concat(newItem);\n    }\n    setBasket(newBasket);\n  }\n\n  const handleRemove = (removedItem) => {\n    const oldBasket = basket;\n    const newBasket = oldBasket.filter((item) => (item.currency !== removedItem.currency));\n    setBasket(newBasket);\n  }\n\n  return (    \n    <Router>\n      <div className=\"AppContent\">\n        <nav>\n              <Link to=\"/shopping-cart/\" id=\"HomeLink\">Home</Link>\n              <Link to=\"/shop\" id=\"ShopLink\">Shop</Link>\n        </nav>\n        <Switch>\n          <Route exact path=\"/shopping-cart/\">\n            <Home />\n          </Route>\n          <Route exact path=\"/shop\">\n            <div className=\"StickyBar\" id=\"stickyNav\">\n              <p>Items in Basket: {basket.length}</p>\n              <Link to=\"/checkout\">Checkout</Link>\n            </div>\n            <Shop \n              onSubmit={handleSubmit}\n            />\n          </Route>\n          <Route path=\"/shop/:currency\" component={ItemDetail}/>\n          <Route path=\"/checkout\">\n            <Checkout basket={basket} onRemove={handleRemove}/>\n          </Route>\n        </Switch>\n        <Footer />\n      </div>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}